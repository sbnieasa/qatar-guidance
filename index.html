<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¯Ø§Ø±Ø© Ù…Ù†ØµØ© Ø¥Ø±Ø´Ø§Ø¯ Ù‚Ø·Ø±</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

    <style>
        :root { --primary: #8D1B3D; --gold: #b2945e; --bg: #f8f9fa; }
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background-color: var(--bg); margin: 0; display: flex; direction: rtl; }

        .sidebar { width: 280px; background: white; height: 100vh; position: fixed; right: 0; top: 0; box-shadow: -2px 0 15px rgba(0,0,0,0.1); z-index: 1000; }
        .sidebar-header { background: var(--primary); color: white; padding: 20px; text-align: center; cursor: pointer; }
        .sidebar-menu a { display: block; padding: 15px 25px; color: #333; text-decoration: none; border-bottom: 1px solid #eee; cursor: pointer; }
        .sidebar-menu a:hover { background: #fdf2f5; color: var(--primary); }

        .main-content { margin-right: 280px; width: calc(100% - 280px); padding: 40px; }
        .hero { background: linear-gradient(45deg, var(--primary), #5d1228); color: white; padding: 50px; border-radius: 20px; text-align: center; }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 9999; justify-content: center; align-items: center; }
        .modal-content { background: white; width: 90%; max-width: 800px; padding: 30px; border-radius: 15px; position: relative; max-height: 85vh; overflow-y: auto; }
        
        .admin-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .stat-badge { display: inline-block; padding: 5px 15px; background: var(--primary); color: white; border-radius: 20px; font-size: 14px; }
        
        .btn { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; margin-top: 10px; }
        input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; }

        /* Floating Bot */
        .bot-container { position: fixed; bottom: 25px; left: 25px; z-index: 9999; }
        .bot-btn { width: 60px; height: 60px; background: var(--primary); border-radius: 50%; color: white; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 25px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-header" onclick="adminLogin()">
            <h2 style="margin:0;">Ø¨ÙˆØµÙ„Ø© Ù‚Ø·Ø± ğŸ›¡ï¸</h2>
            <small>Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</small>
        </div>
        <div class="sidebar-menu">
            <a onclick="showM('uniModal')">ğŸ›ï¸ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø§Øª ÙˆØ§Ù„ØªØ®ØµØµØ§Øª</a>
            <a onclick="showM('scholarshipModal')">âœˆï¸ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø§Ø¨ØªØ¹Ø§Ø«</a>
            <a onclick="showM('quizModal')">ğŸ§  Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ÙŠÙˆÙ„</a>
            <a onclick="showM('bookingModal')">ğŸ“… Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯</a>
        </div>
    </div>

    <div class="main-content">
        <div id="userView">
            <div class="hero">
                <h1>Ù…Ø³ØªÙ‚Ø¨Ù„Ùƒ ÙŠØ¨Ø¯Ø£ Ù…Ù† Ù‡Ù†Ø§</h1>
                <p>Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„Ø¥Ø±Ø´Ø§Ø¯ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ Ù„Ù„Ø·Ù„Ø§Ø¨ ÙÙŠ Ù‚Ø·Ø±</p>
            </div>
        </div>

        <div id="adminView" style="display:none;">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h2 style="color:var(--primary);">ğŸ“Š Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h2>
                <button onclick="location.reload()" style="padding:5px 15px;">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
            </div>
            <div class="admin-card">
                <h3>ğŸ‘¥ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
                <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©: <b id="statCount">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</b></p>
            </div>
            <div class="admin-card">
                <h3>ğŸ“… Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø©</h3>
                <div id="bookingList">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø­Ø§Ù„ÙŠØ§Ù‹</div>
            </div>
        </div>
    </div>

    <div id="quizModal" class="modal">
        <div class="modal-content" id="quizPrint">
            <span onclick="hideM('quizModal')" style="cursor:pointer; float:left;">âœ•</span>
            <div id="quizBody">
                <h2 id="qNum" style="text-align:center; color:var(--primary);"></h2>
                <p id="qText" style="font-size:1.5rem; text-align:center; margin:40px 0;"></p>
                <div style="display:flex; gap:10px;">
                    <button class="btn" style="background:green;" onclick="handleAns(1)">Ø£ÙˆØ§ÙÙ‚ âœ…</button>
                    <button class="btn" style="background:#777;" onclick="handleAns(0)">Ù„Ø§ Ø£ÙˆØ§ÙÙ‚ âŒ</button>
                </div>
            </div>
            <div id="resBody" style="display:none; text-align:center;">
                <h2 id="resType"></h2>
                <p id="resDesc"></p>
                <button class="btn" onclick="saveAndPrint()">Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙˆPDF ğŸ“¥</button>
            </div>
        </div>
    </div>

    <div id="uniModal" class="modal">
        <div class="modal-content">
            <span onclick="hideM('uniModal')" style="cursor:pointer; float:left;">âœ•</span>
            <h2>ğŸ›ï¸ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ©</h2>
            <div style="background:#eee; padding:15px; border-radius:10px; margin-bottom:10px;">
                <b>Ø¬Ø§Ù…Ø¹Ø© Ù‚Ø·Ø±:</b> ØªØ®ØµØµØ§Øª Ø§Ù„Ø·Ø¨ØŒ Ø§Ù„Ù‡Ù†Ø¯Ø³Ø©ØŒ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†. Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…: Ù…Ø§Ø±Ø³ 2026.
            </div>
            <div style="background:#eee; padding:15px; border-radius:10px; margin-bottom:10px;">
                <b>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© (QF):</b> ØªÙƒØ³Ø§Ø³ØŒ ÙƒØ§Ø±Ù†ÙŠØ¬ÙŠ Ù…ÙŠÙ„ÙˆÙ†ØŒ Ù†ÙˆØ±Ø«ÙˆÙŠØ³ØªØ±Ù†.
            </div>
            <a href="https://www.qu.edu.qa" target="_blank" class="btn" style="text-decoration:none; display:block; text-align:center;">Ù…ÙˆÙ‚Ø¹ Ø¬Ø§Ù…Ø¹Ø© Ù‚Ø·Ø± Ø§Ù„Ø±Ø³Ù…ÙŠ</a>
        </div>
    </div>

    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <span onclick="hideM('bookingModal')" style="cursor:pointer; float:left;">âœ•</span>
            <h2>ğŸ“… Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ Ø¥Ø±Ø´Ø§Ø¯ÙŠ</h2>
            <input type="text" id="bName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨">
            <input type="date" id="bDate">
            <button class="btn" onclick="saveBooking()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²</button>
        </div>
    </div>

    <div class="bot-container">
        <div class="bot-btn" onclick="alert('Ø£Ù‡Ù„Ø§Ù‹! Ø£Ù†Ø§ Ø§Ù„Ù…Ø±Ø´Ø¯ Ø§Ù„Ø°ÙƒÙŠØŒ Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ø³Ø£ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ Ø¨Ø´ÙƒÙ„ Ø£Ø¹Ù…Ù‚.')">ğŸ’¬</div>
    </div>

    <script>
        // 1. Firebase Configuration
        const firebaseConfig = { apiKey: "AIzaSyBJCDzV7vPqNDMOfcb1p9gR6x8qi3QMjn8", projectId: "guidance-qatar" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // 2. Modals Control
        function showM(id) { document.getElementById(id).style.display = 'flex'; }
        function hideM(id) { document.getElementById(id).style.display = 'none'; }

        // 3. Quiz Logic (15 Questions)
        const questions = [
            {t: "Ù‡Ù„ ØªØ­Ø¨ ÙÙƒ ÙˆØ¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¢Ù„Ø§ØªØŸ", s: "ÙˆØ§Ù‚Ø¹ÙŠ"},
            {t: "Ù‡Ù„ ØªØ­Ø¨ Ø­Ù„ Ø§Ù„Ù…Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¹Ù„Ù…ÙŠØ©ØŸ", s: "Ø§Ø³ØªÙ‚ØµØ§Ø¦ÙŠ"},
            {t: "Ù‡Ù„ ØªØ³ØªÙ‡ÙˆÙŠÙƒ Ø§Ù„ÙÙ†ÙˆÙ†ØŸ", s: "ÙÙ†ÙŠ"},
            {t: "Ù‡Ù„ ØªØ¬Ø¯ Ù…ØªØ¹Ø© ÙÙŠ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†ØŸ", s: "Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ"},
            {t: "Ù‡Ù„ ØªØ·Ù…Ø­ Ù„Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ØŸ", s: "Ù…Ø¨Ø§Ø¯Ø±"},
            {t: "Ù‡Ù„ ØªÙØ¶Ù„ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ÙƒØªØ¨ÙŠ Ø§Ù„Ù…Ù†Ø¸Ù…ØŸ", s: "ØªÙ‚Ù„ÙŠØ¯ÙŠ"},
            {t: "Ù‡Ù„ ØªØ­Ø¨ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØŸ", s: "ÙˆØ§Ù‚Ø¹ÙŠ"},
            {t: "Ù‡Ù„ ØªØ­Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØªØ¬Ø§Ø±Ø¨ØŸ", s: "Ø§Ø³ØªÙ‚ØµØ§Ø¦ÙŠ"},
            {t: "Ù‡Ù„ ØªØ¹ØªØ¨Ø± Ù†ÙØ³Ùƒ Ù…Ø¨Ø¯Ø¹Ø§Ù‹ØŸ", s: "ÙÙ†ÙŠ"},
            {t: "Ù‡Ù„ ØªØ­Ø¨ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ØªØ·ÙˆØ¹ÙŠØŸ", s: "Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ"},
            {t: "Ù‡Ù„ ØªØ­Ø¨ Ø¥Ù‚Ù†Ø§Ø¹ Ø§Ù„Ù†Ø§Ø³ØŸ", s: "Ù…Ø¨Ø§Ø¯Ø±"},
            {t: "Ù‡Ù„ Ø£Ù†Øª Ø¯Ù‚ÙŠÙ‚ ÙÙŠ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…ØŸ", s: "ØªÙ‚Ù„ÙŠØ¯ÙŠ"},
            {t: "Ù‡Ù„ ØªØ³ØªØ®Ø¯Ù… Ø£Ø¯ÙˆØ§Øª ÙŠØ¯ÙˆÙŠØ©ØŸ", s: "ÙˆØ§Ù‚Ø¹ÙŠ"},
            {t: "Ù‡Ù„ ØªØ­Ø¨ Ø¯Ø±Ø§Ø³Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹Ø©ØŸ", s: "Ø§Ø³ØªÙ‚ØµØ§Ø¦ÙŠ"},
            {t: "Ù‡Ù„ ØªØ³ØªÙ…ØªØ¹ Ø¨ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ù…Ù„ÙØ§ØªØŸ", s: "ØªÙ‚Ù„ÙŠØ¯ÙŠ"}
        ];
        let cur = 0; let scores = {};
        function updateQ() {
            document.getElementById('qNum').innerText = `Ø³Ø¤Ø§Ù„ ${cur+1}/15`;
            document.getElementById('qText').innerText = questions[cur].t;
        }
        function handleAns(v) {
            if(v===1) scores[questions[cur].s] = (scores[questions[cur].s]||0)+1;
            cur++;
            if(cur < 15) updateQ(); else showRes();
        }
        function showRes() {
            document.getElementById('quizBody').style.display='none';
            document.getElementById('resBody').style.display='block';
            let top = Object.keys(scores).reduce((a,b)=> scores[a]>scores[b]?a:b, "Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ");
            document.getElementById('resType').innerText = "Ù†Ù…Ø·Ùƒ: " + top;
            document.getElementById('resDesc').innerText = "Ø£Ù†Øª Ø´Ø®Øµ ØªÙ…ÙŠÙ„ Ù„Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ù€" + top + "Ø©. ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù†ØªÙŠØ¬ØªÙƒ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.";
        }
        updateQ();

        // 4. Data Saving
        function saveAndPrint() {
            db.collection("results").add({ type: document.getElementById('resType').innerText, date: new Date() });
            html2pdf().from(document.getElementById('quizPrint')).save('Result.pdf');
        }

        function saveBooking() {
            const name = document.getElementById('bName').value;
            const date = document.getElementById('bDate').value;
            if(!name || !date) return alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
            db.collection("bookings").add({ name, date }).then(()=>{
                alert("ØªÙ… Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­!");
                hideM('bookingModal');
            });
        }

        // 5. Admin Panel Logic
        function adminLogin() {
            let pass = prompt("Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„:");
            if(pass === "admin123") {
                document.getElementById('userView').style.display = 'none';
                document.getElementById('adminView').style.display = 'block';
                loadAdminData();
            } else {
                alert("ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©");
            }
        }

        function loadAdminData() {
            // Ø¬Ù„Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª
            db.collection("results").get().then(snap => {
                document.getElementById('statCount').innerText = snap.size + " Ø·Ø§Ù„Ø¨";
            });
            // Ø¬Ù„Ø¨ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯
            db.collection("bookings").orderBy("date").get().then(snap => {
                const list = document.getElementById('bookingList');
                list.innerHTML = "";
                snap.forEach(doc => {
                    const d = doc.data();
                    list.innerHTML += `<div style="border-bottom:1px solid #eee; padding:10px;">ğŸ‘¤ ${d.name} | ğŸ“… ${d.date}</div>`;
                });
            });
        }
    </script>
</body>
</html>